<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Search</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script>
    async function doSearch(event) {
      event.preventDefault();
      const query = document.getElementById("q").value;
      const res = await fetch(`/search/api?q=${encodeURIComponent(query)}`);
      const data = await res.json();
      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = "";
      data.forEach(r => {
        const a = document.createElement("a");
        a.className = "result-item";
        a.href = `/player?audio=${encodeURIComponent(r.audio)}&title=${encodeURIComponent(r.title)}&thumb=${encodeURIComponent(r.thumb)}&artist=${encodeURIComponent(r.artist)}`;
        a.innerHTML = `
          <img src="${r.thumb}" alt="" />
          <div class="r-info">
            <div class="r-title">${r.title}</div>
            <div class="r-sub">${r.artist}</div>
          </div>
        `;
        resultsDiv.appendChild(a);
      });
    }
  </script>
</head>
<body class="mobile dark">
  <header class="topbar">
    <button class="back-btn" onclick="location.href='{{ url_for('home') }}'">â†</button>
    <div class="title">Search</div>
    <div class="top-actions">â‹®</div>
  </header>

  <main class="list-screen">
    <form class="search-box" onsubmit="doSearch(event)">
      <input id="q" type="search" name="q" placeholder="Search songs, artists..." value="{{ q }}" />
      <button type="submit">ğŸ”</button>
    </form>

    <section id="results" class="results">
      <!-- results will load here -->
    </section>
  </main>

  <nav class="bottom-nav">
    <a class="nav-item" href="{{ url_for('home') }}">ğŸ </a>
    <a class="nav-item active" href="{{ url_for('search_page') }}">ğŸ”</a>
    <a class="nav-item" href="{{ url_for('profile') }}">ğŸ‘¤</a>
  </nav>
</body>
</html>
