<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{{ title }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="mobile player-screen">
  <header class="topbar">
    <a href="#" onclick="history.back();return false;">âœ•</a>
    <div class="title">Alexa Music ðŸŽ¶</div>
    <div class="menu">â‹®</div>
  </header>

  <div class="album-wrap" style="padding:22px 18px 6px;">
    <img id="main-thumb" class="album-large" src="{{ thumb }}" alt="thumb"
         onerror="this.onerror=null;this.src='{{ url_for('static', filename='img/default_album.png') }}'">
  </div>

  <div style="padding:8px 18px 0;">
    <h2 class="track-title" id="pageTitle">{{ title }}</h2>
    <div class="track-artist" id="pageArtist">Telegram Music</div>
  </div>

  <div style="padding:18px;text-align:center">
    <button class="join-btn big" id="joinRoomBtn">ðŸŸ£ Join Room</button>
  </div>

  <!-- Join Room Modal (hidden by default) -->
  <div id="joinModal" class="modal">
    <div class="modal-inner">
      <h2>Alexa Music âš¡</h2>
      <p class="muted">Tap to join the Room and start the live stream</p>
      <button class="join-btn big" id="confirmJoin">ðŸŽ§ Join Room</button>
      <div style="font-size:13px;margin-top:8px;color:var(--muted)">We'll auto-seek to LIVE if a track is already playing</div>
      <button class="modal-close" id="closeModal">Close</button>
    </div>
  </div>

  <nav class="bottom-nav elevated">
    <a class="nav-item active" href="/">Home</a>
    <a class="nav-item" href="/player">Room</a>
    <a class="nav-item" href="/profile">You</a>
  </nav>

  <script src="{{ url_for('static', filename='script.js') }}"></script>
  <script>
    // open modal when page param join=1 present (useful for direct deep-links)
    (function(){
      const params = new URLSearchParams(window.location.search || "");
      if (params.get('join') === '1') {
        window.openJoinModal && window.openJoinModal();
      }
      // if avatar param present, attempt to preload into DOM (for preview)
      const avatar = "{{ avatar }}";
      if (avatar && document.getElementById('main-thumb')) {
        document.getElementById('main-thumb').src = avatar;
      }
    })();
  </script>
</body>
</html>
